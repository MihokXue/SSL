#????VIF(ȫ????)
#ȫ????
fit <- lm(NASC ~ Lat + Lon + SST + SSS + SSH + MLD + Nppv + Chl + O2 + EKE + Up, data=Mydata)
vif(fit) #O2????

#??ǰ?𲽻ع鷨
#ȫ????
GAM1<-gam(log(NASC) ~ s(Lat), family = gaussian, data = Mydata)
GAM2<-gam(log(NASC) ~ s(Lon), family = gaussian, data = Mydata)
GAM3<-gam(log(NASC) ~ s(SST), family = gaussian, data = Mydata)
GAM4<-gam(log(NASC) ~ s(SSS), family = gaussian, data = Mydata)
GAM5<-gam(log(NASC) ~ s(SSH), family = gaussian, data = Mydata)
GAM6<-gam(log(NASC) ~ s(MLD), family = gaussian, data = Mydata)
GAM7<-gam(log(NASC) ~ s(Nppv), family = gaussian, data = Mydata)
GAM8<-gam(log(NASC) ~ s(EKE), family = gaussian, data = Mydata)
GAM9<-gam(log(NASC) ~ s(Up), family = gaussian, data = Mydata)
AIC1<-c(AIC(GAM1),AIC(GAM2),AIC(GAM3),AIC(GAM4),AIC(GAM5),AIC(GAM6),AIC(GAM7),AIC(GAM8),AIC(GAM9))
AIC1
order(AIC1)
sort(AIC1)#GAM5??С711.7525 

?????ģ?͸????ӵı仯????
fit<-gam(log(NASC) ~ s(SSH) + s(SST) + s(Lon) + s(Lat) + s(SSS) + s(Nppv) + s(MLD), family = gaussian, data = Mydata)#????ѡ????????ģ??????Ϊfit
setwf("SSH.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 1,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(-0.35,1.25),ylim = c(-2,2),xlab = "Sea surface height (m)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SSH, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(-0.2,0,0.2,0.4,0.6,0.8,1.0,1.2), labels = c("-0.2","0","0.2","0.4","0.6","0.8","1","1.2"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("SST.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 2,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(8,28),ylim = c(-3,2),xlab = "Sea surface temperature (??)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SST, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(8,10,12,14,16,18,20,22,24,26,28), labels = c("8","10","12","14","16","18","20","22","24","26","28"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Lon.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 3,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(148,165),ylim = c(-2,2),xlab = "Longitude",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Lon, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164), labels = c("148??","149??","150??","151??","152??","153??","154??","155??","156??","157??","158??","159??","160??","161??","162??","163??","164??E"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Lat.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 4,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(34,46),ylim = c(-2,2),xlab = "Latitude",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Lat, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(34,36,38,40,42,44,46), labels = c("34??","36??","38??","40??","42??","44??","46??N"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("SSS.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 5,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(32.5,35),ylim = c(-2,2),xlab = "Sea surface salinity",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SSS, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(32.5,33,33.5,34,34.5,35), labels = c("32.5","33","33.5","34","34.5","35"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Nppv.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 6,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim = c(3,52),ylim = c(-2,2),xlab = expression('Net primary production'~'(mg/'*m^3*')'),ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Nppv, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3)  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("MLD.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = T,select = 7,pch= 20,cex=0.5,xaxt="n",yaxt="n",xlim= c(10,62),ylim = c(-2,2),xlab = "Mixed layer depth (m)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$MLD, col = "grey", ticksize = 0.03)
axis(1, tcl = 0.3)  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()


#????ʾɢ??
tiff("SSH.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 1,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(-0.35,1.25),ylim = c(-2,2),xlab = "Sea surface height (m)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SSH, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(-0.2,0,0.2,0.4,0.6,0.8,1.0,1.2), labels = c("-0.2","0","0.2","0.4","0.6","0.8","1","1.2"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("SST.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 2,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(8,28),ylim = c(-3,1),xlab = "Sea surface temperature (??)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SST, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(8,10,12,14,16,18,20,22,24,26,28), labels = c("8","10","12","14","16","18","20","22","24","26","28"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3)  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Lon.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 3,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(148,165),ylim = c(-1,1),xlab = "Longitude",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Lon, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164), labels = c("148??","149??","150??","151??","152??","153??","154??","155??","156??","157??","158??","159??","160??","161??","162??","163??","164??E"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3, at = c(-1,-0.5,0,0.5,1),labels = c("-1","-0.5","0","0.5","1"))  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Lat.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 4,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(34,46),ylim = c(-1,0.5),xlab = "Latitude",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Lat, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(34,36,38,40,42,44,46), labels = c("34??","36??","38??","40??","42??","44??","46??N"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3, at = c(-1,-0.5,0,0.5),labels = c("-1","-0.5","0","0.5"))  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("SSS.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 5,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(32.5,35),ylim = c(-1,1),xlab = "Sea surface salinity",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$SSS, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3, at = c(32.5,33,33.5,34,34.5,35), labels = c("32.5","33","33.5","34","34.5","35"))  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3, at = c(-1,-0.5,0,0.5,1),labels = c("-1","-0.5","0","0.5","1"))  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("Nppv.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 6,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim = c(0,52),ylim = c(-1.5,1),xlab = expression('Net primary production'~'(mg/'*m^3*')'),ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$Nppv, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3)  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3, at = c(-1.5,-1,-0.5,0,0.5,1),labels = c("-1.5","-1","-0.5","0","0.5","1"))  # ???? y ???̶??ߺͱ?ǩ
dev.off()

tiff("MLD.tiff", res = 600,width = 4.5, height = 3.1, units = "in")
par(family = "serif",cex.lab = 0.7, cex.axis = 0.7, mgp=c(1,0.2,0))#???ñ?ǩ???塢??ǩ?ֺš????????ֺš???ǩ?????????ľ???
plot(fit,residuals = F,select = 7,pch= 20,cex=0.5,col = "#ED8D5A", shade = TRUE, shade.col = adjustcolor("#ED8D5A", alpha.f = 0.4),xaxt="n",yaxt="n",xlim= c(10,62),ylim = c(-1,0.5),xlab = "Mixed layer depth (m)",ylab = "") 
#residualsΪ?вselectѡ???????ĸ???????ͼ????pch????(plotting character)ָ??ɢ??????״(pch=NA????ʾɢ??),
#xaxt="n"????ʾx??????
rug(Mydata$MLD, col = "#ED8D5A", ticksize = 0.03)
axis(1, tcl = 0.3)  # ???? x ???̶??ߺͱ?ǩ,tcl?߳?
axis(2, tcl = 0.3, at = c(-1,-0.5,0,0.5),labels = c("-1","-0.5","0","0.5"))  # ???? y ???̶??ߺͱ?ǩ
dev.off()
